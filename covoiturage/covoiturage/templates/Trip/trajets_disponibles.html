{% extends 'Home/base.html' %}
{% load static %}
{% block content %}
<h1 class="text-center text-primary my-4">Liste des Trajets Disponibles</h1>

<!-- Formulaire de recherche -->
<form method="GET" class="mb-4 p-4 bg-light rounded shadow-sm d-flex align-items-center">
    <div class="form-group mr-3">
        <label for="point_depart" class="sr-only">Ville de Départ :</label>
        <input type="text" id="point_depart" name="point_depart" class="form-control" placeholder="Ville de départ" value="{{ point_depart }}">
    </div>

    <div class="form-group mr-3">
        <label for="point_arrivee" class="sr-only">Ville d'Arrivée :</label>
        <input type="text" id="point_arrivee" name="point_arrivee" class="form-control" placeholder="Ville d'arrivée" value="{{ point_arrivee }}">
    </div>

    <div class="form-group mr-3">
        <label for="date_depart" class="sr-only">Date de Départ :</label>
        <input type="date" id="date_depart" name="date_depart" class="form-control" value="{{ date_depart }}">
    </div>

    <button type="submit" class="btn btn-primary">Rechercher</button>
</form>

<a href="{% url 'creer_trajet' %}" class="btn btn-success mb-4">Créer un Trajet</a>

<!-- Conteneur des trajets -->
<div class="row">
    {% for trajet in trajets %}
        <div class="col-md-4 mb-4">
            <div class="card shadow-sm">
                <img src="{% static 'rec.jpg' %}" class="card-img-top" alt="Image de trajet">
                <div class="card-body">
                    <h5 class="card-title text-primary">{{ trajet.point_depart }} → {{ trajet.point_arrivee }}</h5>
                    <p class="card-text">
                        <i class="fas fa-calendar-alt"></i> {{ trajet.date_depart }}<br>
                        <i class="fas fa-clock"></i> {{ trajet.heure_depart }}<br>
                        <i class="fas fa-credit-card"></i> {{ trajet.prix_par_place }} DT<br>
                        <i class="fas fa-users"></i> {{ trajet.places_disponibles }} places disponibles
                    </p>
                    <a href="{% url 'afficher_carte' trajet.id %}" class="btn btn-info">Plus de détails</a>
                    <form method="POST" action="{% url 'select_trip' %}" class="d-inline-block">
                        {% csrf_token %}
                        <input type="hidden" name="selected_trip" value="{{ trajet.id }}">
                        <button type="submit" class="btn btn-warning">Réserver</button>
                    </form>
                    <form method="POST" action="{% url 'select_trip1' %}" class="d-inline-block">
                        {% csrf_token %}
                        <input type="hidden" name="selected_trip1" value="{{ trajet.id }}">
                        <button type="submit" class="btn btn-secondary">Ajouter évaluation</button>
                    </form>
                </div>
                
            </div>
        </div>
    {% empty %}
        <p class="text-center">Aucun trajet disponible.</p>
    {% endfor %}
</div>

<!-- Flèche de pagination -->
<a href="{% url 'creer_trajet' %}" class="btn btn-primary position-fixed bottom-0 end-0 mb-4 me-4 rounded-circle" style="font-size: 24px;">
    <i class="fas fa-arrow-right"></i>
</a>
{% endblock %}
